jQuery(document).ready(function($){$(document.body).on("click",".pno-remove-uploaded-file",function(){return $(this).closest(".pno-uploaded-file").remove(),!1}),$(".pno-file-upload").each(function(){$(this).fileupload({dataType:"json",dropZone:$(this),url:pno_ajax_file_upload.ajax_url,maxNumberOfFiles:1,formData:{script:!0},add:function(e,data){var $file_field=$(this),$form=$file_field.closest("form"),uploadErrors=($file_field.parent().find(".pno-uploaded-files"),[]),allowed_types=$(this).data("file_types");if(allowed_types){var acceptFileTypes=new RegExp("(.|/)("+allowed_types+")$","i");data.originalFiles[0].name.length&&!acceptFileTypes.test(data.originalFiles[0].name)&&uploadErrors.push(pno_ajax_file_upload.i18n_invalid_file_type+" "+allowed_types)}0<uploadErrors.length?window.alert(uploadErrors.join("\n")):($form.find(':input[type="submit"]').attr("disabled","disabled"),$file_field.parent().find(".progress").removeClass("d-none"),data.submit())},progress:function(e,data){var progress=parseInt(data.loaded/data.total*100,10);$(this).parent().find(".progress-bar").css("width",progress+"%")},fail:function(e,data){var $file_field=$(this),$form=$file_field.closest("form");data.errorThrown&&window.alert(data.errorThrown),$file_field.parent().find(".progress").addClass("d-none"),$form.find(':input[type="submit"]').removeAttr("disabled")},done:function(e,data){var $file_field=$(this),$form=$file_field.closest("form"),$uploaded_files=$file_field.parent().find(".pno-uploaded-files"),multiple=$file_field.attr("multiple")?1:0,image_types=["jpg","gif","png","jpeg","jpe"];$file_field.parent().find(".progress").addClass("d-none"),void 0===data.result.success||data.result.success||window.alert(data.result.data),$.each(data.result.files,function(index,file){var html;file.error?window.alert(file.error):(0<=$.inArray(file.extension,image_types)?(html=$.parseHTML(pno_ajax_file_upload.js_field_html_img),$(html).find(".pno-uploaded-file-preview img").attr("src",file.url)):(html=$.parseHTML(pno_ajax_file_upload.js_field_html),$(html).find(".pno-uploaded-file-name code").text(file.name)),$(html).find(".input-text").val(file.url),$(html).find(".input-text").attr("name","current_"+$file_field.attr("name")),multiple?$uploaded_files.append(html):$uploaded_files.html(html))}),$form.find(':input[type="submit"]').removeAttr("disabled")}})})});